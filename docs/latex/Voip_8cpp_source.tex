\doxysection{Voip.\+cpp}
\hypertarget{Voip_8cpp_source}{}\label{Voip_8cpp_source}\index{/home/speedie/libleet/src/Voip.cpp@{/home/speedie/libleet/src/Voip.cpp}}
\mbox{\hyperlink{Voip_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ libleet}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Matrix\ client\ library\ written\ in\ C++}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Licensed\ under\ the\ GNU\ Affero\ General\ Public\ License\ version\ 3.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ See\ included\ LICENSE\ file\ for\ more\ information.}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ https://git.speedie.site/speedie/libleet}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials}{leet::VOIP::Credentials}}\ \mbox{\hyperlink{namespaceleet_aedf0824145f0f316d71e16085b4fc0c4}{leet::returnTurnCredentials}}(\mbox{\hyperlink{classleet_1_1User_1_1CredentialsResponse}{leet::User::CredentialsResponse}}*\ resp)\ \{}
\DoxyCodeLine{00010\ \ \ \ \ \mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials}{leet::VOIP::Credentials}}\ cred;}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keyword}{using\ }json\ =\ nlohmann::json;}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ APIUrl\ \{\ \textcolor{stringliteral}{"{}/\_matrix/client/v3/voip/turnServer"{}}\ \};}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ Output\ \{\ \mbox{\hyperlink{namespaceleet_a87681d6edf2064da9cf4df3dcb3ac67e}{leet::invokeRequest\_Get}}(\mbox{\hyperlink{namespaceleet_abf8deb3b48c9f7322aa6654885946738}{leet::getAPI}}(APIUrl),\ resp-\/>\mbox{\hyperlink{classleet_1_1User_1_1CredentialsResponse_ae4d15192559f009ad966de4bc9cdf58a}{accessToken}})\ \};}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ json\ reqOutput;}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ reqOutput\ =\ \{\ json::parse(Output)\ \};}
\DoxyCodeLine{00021\ \ \ \ \ \}\ \ \textcolor{keywordflow}{catch}\ (\textcolor{keyword}{const}\ json::parse\_error\&\ e)\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cred;}
\DoxyCodeLine{00023\ \ \ \ \ \}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ output\ :\ reqOutput)\ \{}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceleet_aa20a9fa2de98421d60165559a8a23f76}{leet::errorCode}}\ =\ 0;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}uris"{}}].is\_array())\ cred.\mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials_a0e92088a4e9d16bfac1535abe3757730}{URI}}\ =\ output[\textcolor{stringliteral}{"{}uris"{}}];}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}username"{}}].is\_string())\ cred.\mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials_aafa81db0f03f6b86a5d5c12a2a3b9140}{Username}}\ =\ output[\textcolor{stringliteral}{"{}username"{}}].get<std::string>();}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}password"{}}].is\_string())\ cred.\mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials_a9a36448f6d146a4e0170b726c8f55e02}{Password}}\ =\ output[\textcolor{stringliteral}{"{}password"{}}].get<std::string>();}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}ttl"{}}].is\_number\_integer())\ cred.\mbox{\hyperlink{classleet_1_1VOIP_1_1Credentials_a98b99d454adbf4986782d6aafe241e25}{timeToLiveIn}}\ =\ output[\textcolor{stringliteral}{"{}ttl"{}}].get<\textcolor{keywordtype}{int}>();}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}errcode"{}}].is\_string())\ \mbox{\hyperlink{namespaceleet_ae7fadb8f554b82e37512ece5f451e345}{leet::Error}}\ =\ output[\textcolor{stringliteral}{"{}errcode"{}}].get<std::string>();}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output[\textcolor{stringliteral}{"{}error"{}}].is\_string())\ \mbox{\hyperlink{namespaceleet_aca8cf23cb2471b07f1ee22a2077b5b37}{leet::friendlyError}}\ =\ output[\textcolor{stringliteral}{"{}error"{}}].get<std::string>();}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordflow}{return}\ cred;}
\DoxyCodeLine{00037\ \}}

\end{DoxyCode}
